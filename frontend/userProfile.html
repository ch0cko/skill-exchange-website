<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>userProfile</title>
    <link rel="stylesheet" href="userProfile.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
  </head>
  <body>
    <header>
      <button id="hamburger" class="hamburger">&#9776;</button>
    </header>

    <!--------------NAV BAR----------------->

    <nav id="sideMenu" class="menu">
      <button id="closeButton" class="close-button">&times;</button>
      <h1>Skill Circle</h1>
      <ul>
        <li>
          <a href="homePage.html"><i class="fas fa-home"></i> Home</a>
        </li>
        <li>
          <a href="dashboard.html"><i class="fas fa-compass"></i> Browse</a>
        </li>
        <li>
          <a href="#"><i class="fas fa-trophy"></i> Rewards</a>
        </li>
        <li>
          <a href="#"><i class="fas fa-info-circle"></i> About Us</a>
        </li>
        <li>
          <a href="#"><i class="fas fa-cog"></i> Settings</a>
        </li>
      </ul>
      <div class="user-prof active">
        <img
          src="https://randomuser.me/api/portraits/women/68.jpg"
          alt="User Profile"
        />
        <span>My Profile</span>
      </div>
    </nav>
    <!-----------USER PROFILE--------------->
    <main class="main-content">
      <section class="profile">
        <div class="profile-header">
          <img id="profileAvatar" class="avatar" alt="User Avatar" />
          <div class="profile-info">
            <h1 id="name-display">Welcome, User</h1>
            <p id="field-display">
              <strong>Field of Study:</strong> Not provided
            </p>
            <p id="cert-display">
              <strong>Certification:</strong> Not provided
            </p>
            <p id="exp-display"><strong>Experience:</strong> Not provided</p>
            <button type="button" id="edit-profile-button" class="edit-btn">
              Edit Profile
            </button>
          </div>
        </div>

        <!--Edit form-->
        <form id="profile-form" class="hidden">
          <label>
            Field of Study:
            <input
              type="text"
              id="field-input"
              placeholder="Enter your field of study"
            />
          </label>
          <label>
            Certification:
            <input
              type="text"
              id="cert-input"
              placeholder="Enter your certification"
            />
          </label>
          <label>
            Experience:
            <textarea
              id="exp-input"
              placeholder="Enter your experience"
            ></textarea>
          </label>
          <label>
            Upload Certificates:
            <input type="file" id="cert-ud" />
          </label>
          <button type="button" id="save-profile">Save Profile</button>
        </form>

        <!--Skills section-->
        <section class="skills">
          <h2>Skills</h2>
          <div class="skill-tags" id="skills-list">
            <p id="no-skills-message">No skills added yet.</p>
          </div>
          <button type="button" id="add-skill-button">Add Skill</button>
          <form id="add-skill-form" class="hide">
            <input type="text" id="new-skill" placeholder="Enter a skill" />
            <button type="button" id="submit-skill-button">Submit</button>
            <button type="button" id="cancel-skill-button">Cancel</button>
          </form>
        </section>

        <!--Bio section-->
        <section class="bio">
          <h2>Bio</h2>
          <p id="bio-display">No bio added yet.</p>
          <button type="button" id="edit-bio-button">Edit Bio</button>
          <form id="bio-form" class="hide">
            <textarea id="bio-input" placeholder="Enter your bio"></textarea>
            <button type="button" id="save-bio-button">Save</button>
            <button type="button" id="cancel-bio-button">Cancel</button>
          </form>
        </section>

        <!--Quests section-->
        <section id="quests-section">
          <h2>Quests</h2>
          <div id="quest-categories">
            <button id="completed-quests-btn" class="quest-category-btn">
              Completed Quests
            </button>
            <button id="in-progress-quests-btn" class="quest-category-btn">
              Quests In Progress
            </button>
            <button id="created-quests-btn" class="quest-category-btn">
              Quests Created
            </button>
          </div>

          <div id="quests-display">
            <!-- Quests dynamically loaded here -->
            <p id="no-quests-message">No quests available in this category.</p>
          </div>

          <button id="add-quest-btn" style="display: none">+</button>
        </section>
      </section>
    </main>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Initialize all features
        setupMenu();
        setupProfile();
        setupSkills();
        setupBio();
      });

      // Menu Section
      function setupMenu() {
        const hamburger = document.getElementById("hamburger");
        const sideMenu = document.getElementById("sideMenu");
        const closeButton = document.getElementById("closeButton");

        sideMenu.classList.add("open"); // Open the menu by default
        hamburger.classList.add("hidden"); // Hide the hamburger icon

        hamburger.addEventListener("click", () => {
          sideMenu.classList.add("open");
          hamburger.classList.add("hidden"); // Hide the hamburger icon
        });

        closeButton.addEventListener("click", () => {
          sideMenu.classList.remove("open");
          hamburger.classList.remove("hidden"); // Show the hamburger icon
        });
      }

      // Profile Section
      function setupProfile() {
        const editProfileButton = document.getElementById(
          "edit-profile-button"
        );
        const saveProfileButton = document.getElementById("save-profile");
        const cancelEditButton = document.getElementById("cancel-edit");
        const profileForm = document.getElementById("profile-form");
        const profileInfo = document.querySelector(".profile-info");

        const fieldDisplay = document.getElementById("field-display");
        const certDisplay = document.getElementById("cert-display");
        const expDisplay = document.getElementById("exp-display");

        const fieldInput = document.getElementById("field-input");
        const certInput = document.getElementById("cert-input");
        const expInput = document.getElementById("exp-input");

        // Load from localStorage
        const loadProfile = () => {
          const profile = JSON.parse(localStorage.getItem("profile")) || {};
          fieldDisplay.textContent = `Field of Study: ${
            profile.fieldOfStudy || "Not provided"
          }`;
          certDisplay.textContent = `Certification: ${
            profile.certification || "Not provided"
          }`;
          expDisplay.textContent = `Experience: ${
            profile.experience || "Not provided"
          }`;
          fieldInput.value = profile.fieldOfStudy || "";
          certInput.value = profile.certification || "";
          expInput.value = profile.experience || "";
        };

        // Save profile to localStorage
        const saveProfile = () => {
          const profile = {
            fieldOfStudy: fieldInput.value,
            certification: certInput.value,
            experience: expInput.value,
          };
          localStorage.setItem("profile", JSON.stringify(profile));
          loadProfile();
        };

        //event listeners
        editProfileButton.addEventListener("click", () => {
          profileForm.classList.remove("hidden");
          profileInfo.classList.add("hidden");
        });
        saveProfileButton.addEventListener("click", () => {
          saveProfile();
          profileForm.classList.add("hidden");
          profileInfo.classList.remove("hidden");
        });
        loadProfile();
      }

      function setupSkills() {
        const skillsList = document.getElementById("skills-list");
        const noSkillsMessage = document.getElementById("no-skills-message");
        const addSkillButton = document.getElementById("add-skill-button");
        const addSkillForm = document.getElementById("add-skill-form");
        const newSkillInput = document.getElementById("new-skill");
        const submitSkillButton = document.getElementById(
          "submit-skill-button"
        );
        const cancelSkillButton = document.getElementById(
          "cancel-skill-button"
        );

        // Show the input form when "Add Skill" is pressed
        addSkillButton.addEventListener("click", () => {
          addSkillForm.classList.remove("hide");
          addSkillButton.classList.add("hide"); // Hide the "Add Skill" button
        });

        // Add the skill when the "Submit" button is pressed
        submitSkillButton.addEventListener("click", () => {
          const skillValue = newSkillInput.value.trim();
          if (skillValue === "") {
            alert("Please enter a skill.");
            return;
          }

          // Remove "No skills added yet" message
          const noSkillsMessage = document.getElementById("no-skills-message");
          if (noSkillsMessage) {
            noSkillsMessage.remove();
          }

          // Create a new skill tag
          const skillTag = document.createElement("span");
          skillTag.textContent = skillValue;
          skillTag.classList.add("skill-tag");

          // Add functionality to remove the skill tag on click
          skillTag.addEventListener("click", () => {
            skillTag.remove();
            if (!skillsList.querySelector("span")) {
              const noSkills = document.createElement("p");
              noSkills.textContent = "No skills added yet.";
              noSkills.id = "no-skills-message";
              skillsList.appendChild(noSkills);
            }
          });

          skillsList.appendChild(skillTag);
          newSkillInput.value = ""; // Clear the input
          addSkillForm.classList.add("hide"); // Hide the form
          addSkillButton.classList.remove("hide"); // Show "Add Skill" button

          // Save skill to localStorage
          const skills = JSON.parse(localStorage.getItem("skills")) || [];
          skills.push(skillValue);
          localStorage.setItem("skills", JSON.stringify(skills));
        });

        // Cancel adding a skill
        cancelSkillButton.addEventListener("click", () => {
          newSkillInput.value = ""; // Clear the input
          addSkillForm.classList.add("hide"); // Hide the form
          addSkillButton.classList.remove("hide"); // Show "Add Skill" button
        });

        // Load skills from localStorage
        const loadSkills = () => {
          const skills = JSON.parse(localStorage.getItem("skills")) || [];
          skillsList.innerHTML = "";
          if (skills.length === 0) {
            skillsList.innerHTML =
              "<p id='no-skills-message'>No skills added yet.</p>";
          } else {
            skills.forEach((skill) => {
              const skillTag = document.createElement("span");
              skillTag.textContent = skill;
              skillTag.classList.add("skill-tag");

              // Add functionality to remove the skill tag on click
              skillTag.addEventListener("click", () => {
                skillTag.remove();
                const remainingSkills = Array.from(
                  skillsList.querySelectorAll(".skill-tag")
                ).map((tag) => tag.textContent);

                localStorage.setItem("skills", JSON.stringify(remainingSkills));

                if (!skillsList.querySelector(".skill-tag")) {
                  skillsList.innerHTML =
                    "<p id='no-skills-message'>No skills added yet.</p>";
                }
              });

              skillsList.appendChild(skillTag);
            });
          }
        };

        // Load skills on page load
        loadSkills();
      }

      // Bio Section
      function setupBio() {
        const bioDisplay = document.getElementById("bio-display");
        const editBioButton = document.getElementById("edit-bio-button");
        const bioForm = document.getElementById("bio-form");
        const bioInput = document.getElementById("bio-input");
        const saveBioButton = document.getElementById("save-bio-button");
        const cancelBioButton = document.getElementById("cancel-bio-button");

        const loadBio = () => {
          const bio = localStorage.getItem("bio") || "No bio added yet.";
          bioDisplay.textContent = bio;
          bioInput.value = bio !== "No bio added yet." ? bio : "";
        };

        const saveBio = () => {
          const bio = bioInput.value.trim();
          if (bio === "") {
            alert("Bio cannot be empty.");
            return;
          }
          localStorage.setItem("bio", bio);
          loadBio();
        };

        editBioButton.addEventListener("click", () => {
          bioForm.classList.remove("hide");
          editBioButton.classList.add("hide");
        });

        saveBioButton.addEventListener("click", () => {
          saveBio();
          bioForm.classList.add("hide");
          editBioButton.classList.remove("hide");
        });

        cancelBioButton.addEventListener("click", () => {
          bioForm.classList.add("hide");
          editBioButton.classList.remove("hide");
        });

        loadBio();
      }

      document.addEventListener("DOMContentLoaded", () => {
        const quests = {
          completed: [
            {
              title: "Cooking Quest",
              author: "Matthew Mercer",
              description:
                "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
              image: "images/cooking.jpg",
              buttonText: "View Quest",
            },
          ],
          inProgress: [
            {
              title: "Dancing Quest",
              author: "Matthew Mercer",
              description:
                "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
              image: "images/dance.jpg",
              buttonText: "Continue Quest",
            },
          ],
          created: [],
        };

        const questsDisplay = document.getElementById("quests-display");
        const noQuestsMessage = document.getElementById("no-quests-message");
        const completedQuestsBtn = document.getElementById(
          "completed-quests-btn"
        );
        const inProgressQuestsBtn = document.getElementById(
          "in-progress-quests-btn"
        );
        const createdQuestsBtn = document.getElementById("created-quests-btn");
        const addQuestBtn = document.getElementById("add-quest-btn");

        const userXP = 120; // Example: User's current XP
        const requiredXPForCreateQuest = 100; // Set this to the required XP amount

        // Conditionally enable or disable "Create Quest" button
        if (userXP >= requiredXPForCreateQuest) {
          addQuestBtn.style.display = "block"; // Show the button
        } else {
          addQuestBtn.style.display = "none"; // Hide the button
        }

        const loadQuests = (category) => {
          questsDisplay.innerHTML = ""; // Clear current quests

          if (quests[category].length === 0) {
            noQuestsMessage.style.display = "block"; // Show "No quests" message
          } else {
            noQuestsMessage.style.display = "none"; // Hide "No quests" message
            quests[category].forEach((quest) => {
              const questCard = document.createElement("div");
              questCard.classList.add("quest-card");

              questCard.innerHTML = `
          <img src="${quest.image}" alt="${quest.title}">
          <div class="quest-card-content">
            <h3 class="quest-card-title">${quest.title}</h3>
            <p class="quest-card-author">${quest.author}</p>
            <p class="quest-card-description">${quest.description}</p>
          </div>
          <button>${quest.buttonText}</button>
        `;

              questsDisplay.appendChild(questCard);
            });
          }
        };

        // Event listeners for category buttons
        completedQuestsBtn.addEventListener("click", () =>
          loadQuests("completed")
        );
        inProgressQuestsBtn.addEventListener("click", () =>
          loadQuests("inProgress")
        );
        createdQuestsBtn.addEventListener("click", () => loadQuests("created"));

        // Add Quest Button (example functionality)
        addQuestBtn.addEventListener("click", () => {
          const newQuest = {
            title: "New Quest",
            author: "New Author",
            description: "This is a newly added quest.",
            image: "new-quest.jpg",
            buttonText: "Start Quest",
          };

          quests.created.push(newQuest);
          loadQuests("created");
        });

        // Load "Completed Quests" by default
        loadQuests("completed");
      });
    </script>
  </body>
</html>
